# å›½é™…æ–°é—»çˆ¬è™« (International News Crawler)

è‡ªåŠ¨çˆ¬å–å…¨çƒä¸»è¦æ–°é—»ç½‘ç«™çš„æ–°é—»å†…å®¹ï¼Œæ”¯æŒå®šæ—¶æ‰«æã€æ›´æ–°æ£€æµ‹å’Œåˆ†ç±»ç®¡ç†ã€‚

## ğŸŒ æ”¯æŒçš„å›½å®¶/åœ°åŒº

æœ¬æ¨¡å—æ”¯æŒä»ä»¥ä¸‹å›½å®¶/åœ°åŒºçš„ä¸»è¦æ–°é—»ç½‘ç«™çˆ¬å–å†…å®¹ï¼š

### ä¸œäºš
- ğŸ‡¯ğŸ‡µ æ—¥æœ¬ (14ä¸ªç½‘ç«™): å…±åŒç¤¾ã€NHKã€æœæ—¥æ–°é—»ã€è¯»å–æ–°é—»ç­‰
- ğŸ‡°ğŸ‡· éŸ©å›½ (4ä¸ªç½‘ç«™): éŸ©è”ç¤¾ã€å¤§çºªå…ƒç­‰
- ğŸ‡°ğŸ‡µ æœé²œ (1ä¸ªç½‘ç«™): æœé²œæ—¥æŠ¥

### ä¸œå—äºš
- ğŸ‡²ğŸ‡¾ é©¬æ¥è¥¿äºš (10ä¸ªç½‘ç«™): æ˜Ÿæ´²æ—¥æŠ¥ã€å…‰æ˜æ—¥æŠ¥ã€ä¸œæ–¹æ—¥æŠ¥ç­‰
- ğŸ‡¸ğŸ‡¬ æ–°åŠ å¡ (2ä¸ªç½‘ç«™): è”åˆæ—©æŠ¥ã€å…‰æ˜æ—¥æŠ¥
- ğŸ‡»ğŸ‡³ è¶Šå— (2ä¸ªç½‘ç«™): è¶Šå—é€šè®¯ç¤¾ã€è¶Šå—ä¹‹å£°
- ğŸ‡²ğŸ‡² ç¼…ç”¸ (1ä¸ªç½‘ç«™): ç¼…ç”¸æ°‘ä¸»ä¹‹å£°

### å¤§ä¸­å
- ğŸ‡­ğŸ‡° é¦™æ¸¯ (21ä¸ªç½‘ç«™): è‹¹æœæ—¥æŠ¥ã€å—åæ—©æŠ¥ã€é¦™æ¸¯01ç­‰
- ğŸ‡²ğŸ‡´ æ¾³é—¨ (12ä¸ªç½‘ç«™): æ¾³é—¨æ—¥æŠ¥ã€åŠ›æŠ¥ã€æ­£æŠ¥ç­‰
- ğŸ‡¹ğŸ‡¼ å°æ¹¾ (13ä¸ªç½‘ç«™): è‡ªç”±æ—¶æŠ¥ã€è”åˆæŠ¥ã€ä¸­æ—¶ç”µå­æŠ¥ç­‰

### æ¬§æ´²
- ğŸ‡¬ğŸ‡§ è‹±å›½ (8ä¸ªç½‘ç«™): è·¯é€ç¤¾ã€BBCã€é‡‘èæ—¶æŠ¥ã€å«æŠ¥ç­‰
- ğŸ‡«ğŸ‡· æ³•å›½ (5ä¸ªç½‘ç«™): æ³•æ–°ç¤¾ã€ä¸–ç•ŒæŠ¥ã€è´¹åŠ ç½—æŠ¥ç­‰
- ğŸ‡©ğŸ‡ª å¾·å›½ (1ä¸ªç½‘ç«™): å¾·å›½ä¹‹å£°
- ğŸ‡®ğŸ‡ª çˆ±å°”å…° (1ä¸ªç½‘ç«™): å¼€æ”¾æ‚å¿—
- ğŸ‡·ğŸ‡º ä¿„ç½—æ–¯ (4ä¸ªç½‘ç«™): ä¿„æ–°ç¤¾ã€å«æ˜Ÿé€šè®¯ç¤¾ç­‰

### åŒ—ç¾
- ğŸ‡ºğŸ‡¸ ç¾å›½ (22ä¸ªç½‘ç«™): çº½çº¦æ—¶æŠ¥ã€åå°”è¡—æ—¥æŠ¥ã€CNNã€ç¾è”ç¤¾ç­‰

### å¤§æ´‹æ´²
- ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºš (3ä¸ªç½‘ç«™): æ¾³å¹¿ã€æ¯æ—¥ç”µè®¯æŠ¥ç­‰
- ğŸ‡³ğŸ‡¿ æ–°è¥¿å…° (2ä¸ªç½‘ç«™): çœ‹ä¸­å›½ã€é˜¿æ³¢ç½—ç½‘

### å—äºš
- ğŸ‡®ğŸ‡³ å°åº¦ (3ä¸ªç½‘ç«™): å°åº¦æ–¯å¦æ—¶æŠ¥ã€å°åº¦æ•™å¾’æŠ¥ã€å°åº¦å¿«æŠ¥

### å…¶ä»–
- ğŸ‡¦ğŸ‡¿ é˜¿å¡æ‹œç–† (3ä¸ªç½‘ç«™)

**æ€»è®¡ï¼šè¶…è¿‡ 130 ä¸ªå›½é™…æ–°é—»ç½‘ç«™**

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- âœ… **åˆ†ç±»ç®¡ç†** - æŒ‰å›½å®¶/åœ°åŒºåˆ†ç±»ç»„ç»‡æ–°é—»ç½‘ç«™
- âœ… **å®šæ—¶æ‰«æ** - å¯é…ç½®çš„æ‰«æé—´éš”ï¼Œè‡ªåŠ¨æ£€æŸ¥æ›´æ–°
- âœ… **æ›´æ–°æ£€æµ‹** - æ™ºèƒ½è¯†åˆ«æ–°æ–‡ç« ï¼Œé¿å…é‡å¤çˆ¬å–
- âœ… **é€šç”¨çˆ¬è™«** - è‡ªé€‚åº”å¤šç§ç½‘ç«™ç»“æ„çš„æ™ºèƒ½æå–ç®—æ³•
- âœ… **å¹¶è¡Œå¤„ç†** - æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘çˆ¬å–ï¼Œæå‡æ•ˆç‡
- âœ… **å†å²è¿½è¸ª** - SQLite æ•°æ®åº“è®°å½•çˆ¬å–å†å²å’Œç»Ÿè®¡
- âœ… **çµæ´»é…ç½®** - å¯é’ˆå¯¹æ¯ä¸ªç½‘ç«™é…ç½®æ‰«æé—´éš”å’Œå¯ç”¨çŠ¶æ€
- âœ… **å‘½ä»¤è¡Œå·¥å…·** - å®Œæ•´çš„ CLI å·¥å…·ï¼Œæ–¹ä¾¿è‡ªåŠ¨åŒ–éƒ¨ç½²

## ğŸš€ å¿«é€Ÿå¼€å§‹

### å®‰è£…ä¾èµ–

```bash
# è¿›å…¥é¡¹ç›®ç›®å½•
cd /home/user/webapp

# ä½¿ç”¨ uv å®‰è£…ä¾èµ–
uv sync
```

### åŸºæœ¬ä½¿ç”¨

```bash
# 1. åˆ—å‡ºæ‰€æœ‰å¯ç”¨å›½å®¶
uv run python -m news_crawler.international_news.cli list --countries

# 2. åˆ—å‡ºæ‰€æœ‰å¯ç”¨åœ°åŒº
uv run python -m news_crawler.international_news.cli list --regions

# 3. æŸ¥çœ‹æŸä¸ªå›½å®¶çš„æ‰€æœ‰ç½‘ç«™
uv run python -m news_crawler.international_news.cli list --country ç¾å›½

# 4. æ‰«ææ‰€æœ‰ç½‘ç«™(ä¸€æ¬¡æ€§)
uv run python -m news_crawler.international_news.cli scan --all --max-articles 5

# 5. åªæ‰«æç‰¹å®šå›½å®¶
uv run python -m news_crawler.international_news.cli scan --country æ—¥æœ¬ --max-articles 5

# 6. åªæ‰«æç‰¹å®šåœ°åŒº
uv run python -m news_crawler.international_news.cli scan --region ä¸œäºš --max-articles 5

# 7. å¯åŠ¨æŒç»­æ‰«æ(æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡)
uv run python -m news_crawler.international_news.cli start --interval 3600

# 8. æŸ¥çœ‹çˆ¬å–ç»Ÿè®¡
uv run python -m news_crawler.international_news.cli stats --days 7 --history

# 9. é…ç½®ç‰¹å®šç½‘ç«™
uv run python -m news_crawler.international_news.cli config --site "BBC" --interval 7200 --enable
```

## ğŸ“– ä½¿ç”¨æŒ‡å—

### 1. åˆ—å‡ºç½‘ç«™

```bash
# åˆ—å‡ºæ‰€æœ‰å›½å®¶
uv run python -m news_crawler.international_news.cli list --countries

# åˆ—å‡ºæ‰€æœ‰åœ°åŒºåˆ†ç»„
uv run python -m news_crawler.international_news.cli list --regions

# åˆ—å‡ºæŸä¸ªå›½å®¶çš„ç½‘ç«™
uv run python -m news_crawler.international_news.cli list --country æ—¥æœ¬

# åˆ—å‡ºæŸä¸ªåœ°åŒºçš„ç½‘ç«™
uv run python -m news_crawler.international_news.cli list --region ä¸œäºš

# åŒ…å«å·²ç¦ç”¨çš„ç½‘ç«™
uv run python -m news_crawler.international_news.cli list --country ç¾å›½ --all
```

### 2. æ‰«æç½‘ç«™

```bash
# æ‰«ææ‰€æœ‰ç½‘ç«™
uv run python -m news_crawler.international_news.cli scan --all

# æ‰«æç‰¹å®šå›½å®¶
uv run python -m news_crawler.international_news.cli scan --country ç¾å›½ --max-articles 10

# æ‰«æç‰¹å®šåœ°åŒº
uv run python -m news_crawler.international_news.cli scan --region ä¸œäºš --max-articles 5

# æ˜¾ç¤ºè¯¦ç»†ä¿¡æ¯
uv run python -m news_crawler.international_news.cli scan --all --verbose --show-articles

# è‡ªå®šä¹‰å¹¶å‘æ•°
uv run python -m news_crawler.international_news.cli scan --all --workers 10
```

### 3. æŒç»­æ‰«æ

```bash
# å¯åŠ¨æŒç»­æ‰«æ(é»˜è®¤æ¯å°æ—¶æ£€æŸ¥ä¸€æ¬¡)
uv run python -m news_crawler.international_news.cli start --interval 3600

# åªæ‰«æç‰¹å®šå›½å®¶
uv run python -m news_crawler.international_news.cli start --country æ—¥æœ¬ --interval 1800

# åªæ‰«æç‰¹å®šåœ°åŒº
uv run python -m news_crawler.international_news.cli start --region ä¸œäºš --interval 3600

# è‡ªå®šä¹‰è®¾ç½®
uv run python -m news_crawler.international_news.cli start \
    --interval 7200 \
    --max-articles 20 \
    --workers 8
```

### 4. æŸ¥çœ‹ç»Ÿè®¡

```bash
# æŸ¥çœ‹æœ€è¿‘7å¤©çš„ç»Ÿè®¡
uv run python -m news_crawler.international_news.cli stats --days 7

# æŸ¥çœ‹ç»Ÿè®¡å¹¶æ˜¾ç¤ºå†å²è®°å½•
uv run python -m news_crawler.international_news.cli stats --days 30 --history --limit 50
```

### 5. é…ç½®ç½‘ç«™

```bash
# åˆ—å‡ºæ‰€æœ‰å¯é…ç½®çš„ç½‘ç«™
uv run python -m news_crawler.international_news.cli config --list-sites

# å¯ç”¨æŸä¸ªç½‘ç«™
uv run python -m news_crawler.international_news.cli config --site "BBC" --enable

# ç¦ç”¨æŸä¸ªç½‘ç«™
uv run python -m news_crawler.international_news.cli config --site "CNN" --disable

# è®¾ç½®æ‰«æé—´éš”(ç§’)
uv run python -m news_crawler.international_news.cli config --site "çº½çº¦æ—¶æŠ¥" --interval 7200

# åŒæ—¶è®¾ç½®å¤šä¸ªå‚æ•°
uv run python -m news_crawler.international_news.cli config --site "æ—¥ç»æ–°é—»" --enable --interval 3600
```

## ğŸ”§ Python API ä½¿ç”¨

### åŸºæœ¬çˆ¬å–

```python
from news_crawler.international_news import InternationalNewsCrawler

# åˆ›å»ºçˆ¬è™«å®ä¾‹
crawler = InternationalNewsCrawler(
    news_url="https://www.bbc.com/news/world",
    site_config={
        'name': 'BBC',
        'type': 'broadcast',
        'encoding': 'utf-8'
    }
)

# æå–æœ€æ–°æ–‡ç« åˆ—è¡¨
articles = crawler.extract_latest_articles(max_articles=10)
for article in articles:
    print(f"æ ‡é¢˜: {article['title']}")
    print(f"URL: {article['url']}")

# çˆ¬å–å•ç¯‡æ–‡ç« 
crawler_single = InternationalNewsCrawler(
    news_url="https://www.bbc.com/news/world-12345678",
    site_config={'name': 'BBC'}
)
news_item = crawler_single.run()
print(f"æ ‡é¢˜: {news_item.title}")
print(f"å†…å®¹: {len(news_item.contents)} ä¸ªå†…å®¹é¡¹")
```

### ä½¿ç”¨é…ç½®ç®¡ç†å™¨

```python
from news_crawler.international_news import ConfigManager

# åˆå§‹åŒ–ç®¡ç†å™¨
manager = ConfigManager()
manager.load_site_configs()

# è·å–æ‰€æœ‰ç¾å›½ç½‘ç«™
us_sites = manager.get_sites_by_filter(country="ç¾å›½")
for site in us_sites:
    print(f"{site['site_name']}: {site['site_url']}")

# è·å–éœ€è¦æ‰«æçš„ç½‘ç«™
sites_to_scan = manager.get_sites_to_scan()
print(f"éœ€è¦æ‰«æ {len(sites_to_scan)} ä¸ªç½‘ç«™")

# è®°å½•çˆ¬å–å†å²
manager.record_crawl(
    site_name="BBC",
    site_url="https://www.bbc.com",
    country="è‹±å›½",
    article_url="https://www.bbc.com/news/12345",
    article_title="Sample Article",
    status="success",
    article_count=1
)

# æŸ¥çœ‹ç»Ÿè®¡
stats = manager.get_crawl_statistics(days=7)
print(f"æˆåŠŸç‡: {stats['success_rate']}")
print(f"æ€»æ–‡ç« æ•°: {stats['total_articles']}")
```

### ä½¿ç”¨è°ƒåº¦å™¨

```python
from news_crawler.international_news import NewsScheduler, ConfigManager

# åˆå§‹åŒ–
manager = ConfigManager()
manager.load_site_configs()

scheduler = NewsScheduler(
    config_manager=manager,
    max_workers=5
)

# ä¸€æ¬¡æ€§æ‰«ææ‰€æœ‰ç½‘ç«™
results = scheduler.scan_all_sites(max_articles_per_site=10)
print(f"æ‰«æäº† {len(results)} ä¸ªç½‘ç«™")
print(f"å‘ç° {sum(r['new_articles'] for r in results)} ç¯‡æ–°æ–‡ç« ")

# æ‰«æç‰¹å®šå›½å®¶
results = scheduler.scan_all_sites(
    country="æ—¥æœ¬",
    max_articles_per_site=5,
    parallel=True
)

# å¯åŠ¨æŒç»­æ‰«æ
scheduler.start_continuous_scanning(
    check_interval=3600,  # æ¯å°æ—¶æ£€æŸ¥
    max_articles_per_site=10
)
```

### è‡ªå®šä¹‰å›è°ƒ

```python
from news_crawler.international_news import NewsScheduler, ConfigManager

def on_article_crawled(news_item, site_name, country):
    """å½“æ–‡ç« è¢«çˆ¬å–æ—¶çš„å›è°ƒ"""
    print(f"[{country}] {site_name}: {news_item.title}")
    # å¯ä»¥åœ¨è¿™é‡Œæ·»åŠ è‡ªå®šä¹‰å¤„ç†é€»è¾‘
    # ä¾‹å¦‚ï¼šå‘é€é€šçŸ¥ã€å­˜å…¥æ•°æ®åº“ã€è§¦å‘åˆ†æç­‰

manager = ConfigManager()
manager.load_site_configs()

scheduler = NewsScheduler(
    config_manager=manager,
    on_article_crawled=on_article_crawled
)

# æ‰«ææ—¶ä¼šè§¦å‘å›è°ƒ
results = scheduler.scan_all_sites(max_articles_per_site=5)
```

## ğŸ“Š æ•°æ®å­˜å‚¨

### æ–‡ä»¶å­˜å‚¨

çˆ¬å–çš„æ–°é—»å†…å®¹ä¿å­˜åœ¨ä»¥ä¸‹ä½ç½®ï¼š

```
data/international_news/
â”œâ”€â”€ {article_id_1}.json
â”œâ”€â”€ {article_id_2}.json
â””â”€â”€ ...
```

æ¯ä¸ªæ–‡ç« ä¿å­˜ä¸ºæ ‡å‡†çš„ JSON æ ¼å¼ï¼š

```json
{
  "title": "æ–‡ç« æ ‡é¢˜",
  "news_url": "æ–‡ç« URL",
  "news_id": "æ–‡ç« ID",
  "meta_info": {
    "author_name": "ä½œè€…",
    "publish_time": "2024-01-01 12:00:00"
  },
  "contents": [
    {"type": "text", "content": "æ®µè½å†…å®¹", "desc": ""},
    {"type": "image", "content": "å›¾ç‰‡URL", "desc": "å›¾ç‰‡æè¿°"}
  ],
  "texts": ["æ®µè½1", "æ®µè½2"],
  "images": ["å›¾ç‰‡URL1", "å›¾ç‰‡URL2"],
  "extra": {
    "site_name": "ç½‘ç«™å",
    "site_type": "ç½‘ç«™ç±»å‹",
    "extracted_at": "2024-01-01T12:00:00"
  }
}
```

### æ•°æ®åº“å­˜å‚¨

çˆ¬å–å†å²å’Œé…ç½®å­˜å‚¨åœ¨ SQLite æ•°æ®åº“ï¼š

```
data/international_news/crawl_history.db
```

åŒ…å«ä»¥ä¸‹è¡¨ï¼š
- `site_configs` - ç½‘ç«™é…ç½®
- `crawl_history` - çˆ¬å–å†å²
- `latest_articles` - æœ€æ–°æ–‡ç« è¿½è¸ª

## âš™ï¸ é…ç½®è¯´æ˜

### æ‰«æé—´éš”

æ¯ä¸ªç½‘ç«™å¯ä»¥é…ç½®ç‹¬ç«‹çš„æ‰«æé—´éš”(ä»¥ç§’ä¸ºå•ä½):

- é»˜è®¤: 3600 ç§’ (1å°æ—¶)
- å»ºè®®èŒƒå›´: 1800-7200 ç§’ (30åˆ†é’Ÿ - 2å°æ—¶)
- é‡è¦ç½‘ç«™å¯è®¾ç½®æ›´çŸ­é—´éš”
- ä¸å¸¸æ›´æ–°çš„ç½‘ç«™å¯è®¾ç½®æ›´é•¿é—´éš”

### å¹¶å‘è®¾ç½®

- `max_workers`: å¹¶å‘çº¿ç¨‹æ•°ï¼Œé»˜è®¤ 5
- å»ºè®®æ ¹æ®ç½‘ç»œå¸¦å®½å’Œç³»ç»Ÿèµ„æºè°ƒæ•´
- è¿‡é«˜å¯èƒ½å¯¼è‡´è¢«ç½‘ç«™å°ç¦
- è¿‡ä½å½±å“çˆ¬å–æ•ˆç‡

### æ–‡ç« æ•°é‡

- `max_articles_per_site`: æ¯ä¸ªç½‘ç«™çˆ¬å–çš„æœ€å¤§æ–‡ç« æ•°
- é»˜è®¤: 10 ç¯‡
- å»ºè®®: 5-20 ç¯‡ä¹‹é—´
- é¦–æ¬¡è¿è¡Œå¯è®¾ç½®è¾ƒå¤§å€¼

## ğŸ› ï¸ é«˜çº§åŠŸèƒ½

### è‡ªå®šä¹‰ç½‘ç«™é…ç½®

å¯ä»¥åœ¨ä»£ç ä¸­åŠ¨æ€æ·»åŠ æ–°ç½‘ç«™ï¼š

```python
from news_crawler.international_news.configs.sites_config import NEWS_SITES_CONFIG

# æ·»åŠ æ–°ç½‘ç«™
NEWS_SITES_CONFIG["æ–°å›½å®¶"] = [
    {
        "name": "æ–°ç½‘ç«™",
        "url": "https://example.com",
        "encoding": "utf-8",
        "type": "newspaper"
    }
]
```

### æ‰©å±•çˆ¬è™«åŠŸèƒ½

ç»§æ‰¿ `InternationalNewsCrawler` ç±»å¯ä»¥è‡ªå®šä¹‰çˆ¬å–é€»è¾‘ï¼š

```python
from news_crawler.international_news import InternationalNewsCrawler

class CustomNewsCrawler(InternationalNewsCrawler):
    def _extract_title(self, selector):
        # è‡ªå®šä¹‰æ ‡é¢˜æå–é€»è¾‘
        return selector.css('h1.custom-title::text').get() or super()._extract_title(selector)
    
    def _extract_main_content(self, selector):
        # è‡ªå®šä¹‰å†…å®¹æå–é€»è¾‘
        # ...
        return contents
```

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **éµå®ˆ robots.txt**: çˆ¬å–å‰è¯·æ£€æŸ¥ç›®æ ‡ç½‘ç«™çš„ robots.txt æ–‡ä»¶
2. **æ§åˆ¶é¢‘ç‡**: é¿å…è¿‡äºé¢‘ç¹çš„è¯·æ±‚ï¼Œå»ºè®®æ¯ä¸ªç½‘ç«™é—´éš”è‡³å°‘ 1-2 ç§’
3. **é”™è¯¯å¤„ç†**: ç½‘ç«™ç»“æ„å¯èƒ½å˜åŒ–ï¼Œå¯¼è‡´çˆ¬å–å¤±è´¥ï¼Œéœ€å®šæœŸæ£€æŸ¥
4. **æ³•å¾‹åˆè§„**: ä»…ç”¨äºå­¦ä¹ ç ”ç©¶ï¼Œä¸å¾—ç”¨äºå•†ä¸šç”¨é€”
5. **ç½‘ç»œç¯å¢ƒ**: æŸäº›ç½‘ç«™å¯èƒ½éœ€è¦ä»£ç†æ‰èƒ½è®¿é—®

## ğŸ¤ è´¡çŒ®

æ¬¢è¿è´¡çŒ®æ–°çš„ç½‘ç«™é…ç½®æˆ–æ”¹è¿›çˆ¬å–ç®—æ³•ï¼

## ğŸ“„ è®¸å¯

æœ¬é¡¹ç›®ä»…ä¾›æ•™è‚²å’Œç ”ç©¶ä½¿ç”¨ã€‚

---

**å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æäº¤ Issueï¼**
